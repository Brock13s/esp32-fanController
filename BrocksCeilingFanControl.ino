// Firmware to control my ceiling fan from webpage, alexa and by ntp time.
// Author Brock Mills

#include <AsyncTCP.h>
#include <RCSwitch.h>
#include <ESPAsyncWebServer.h>
#include <WiFi.h>
#include <SPIFFS.h>
#include "time.h"
#include "wifi_credentials.h"

#define red_led 26
#define white_led 23
#define green_led 32
#define transmitterLed 22
#define transmitterPin 25
#define buttonPin 34
#define temperatureSensor 33

unsigned long previousTimes[6] = {0};
uint8_t fanlightOnTime[3] = {18, 00, 0};
uint8_t fanOnTime[3] = {20, 30, 0};
uint8_t fanlightOffTime[3] = {06, 30, 0};
byte fanTOT = 27;
bool blinkOn = false;
String message = "FANCODE_OFF";

bool lightState = false;
bool ktState = false;

RCSwitch mySwitch = RCSwitch();
AsyncWebServer server(80);
AsyncWebSocket ws("/ws");

IPAddress local_IP(192, 168, 68, 25);
IPAddress gateway(192, 168, 68, 1);
IPAddress subnet(255, 255, 252, 0);
IPAddress DNS(202, 142, 142, 142);

const float ADC_LUT[4096] PROGMEM = { 0,
                                      84.0000, 92.0000, 96.8000, 97.8000, 98.8000, 99.8000, 100.8000, 102.0000, 103.0000, 104.0000, 105.0000, 106.0000, 107.0000, 108.0000, 109.0000,
                                      110.2000, 111.2000, 112.2000, 113.2000, 114.2000, 115.2000, 116.4000, 117.4000, 118.4000, 119.4000, 120.4000, 121.4000, 122.4000, 123.4000, 124.4000,
                                      125.4000, 126.4000, 127.4000, 128.4000, 129.8000, 130.8000, 132.0000, 133.0000, 134.0000, 135.4000, 136.6000, 137.8000, 138.8000, 140.0000, 141.0000,
                                      142.2000, 143.6000, 144.8000, 145.6000, 146.6000, 147.4000, 148.4000, 149.2000, 150.2000, 151.0000, 152.0000, 153.0000, 154.0000, 155.0000, 156.0000,
                                      157.0000, 158.0000, 158.8000, 159.8000, 160.8000, 162.0000, 163.0000, 164.4000, 165.6000, 166.8000, 167.8000, 169.0000, 170.0000, 171.2000, 172.6000,
                                      173.8000, 174.8000, 176.0000, 177.0000, 178.0000, 179.4000, 180.6000, 181.8000, 182.8000, 184.0000, 185.0000, 186.0000, 187.2000, 188.6000, 189.8000,
                                      190.8000, 191.8000, 193.0000, 193.8000, 194.8000, 195.8000, 196.8000, 197.8000, 198.8000, 199.8000, 200.8000, 201.8000, 202.8000, 203.8000, 204.8000,
                                      205.8000, 206.8000, 207.8000, 208.8000, 210.2000, 211.8000, 213.0000, 214.8000, 216.0000, 217.8000, 219.0000, 220.8000, 222.0000, 223.6000, 224.8000,
                                      225.8000, 226.8000, 227.8000, 228.8000, 230.0000, 231.0000, 232.0000, 233.0000, 234.0000, 235.0000, 236.0000, 237.0000, 238.0000, 239.0000, 240.2000,
                                      241.0000, 242.0000, 243.0000, 244.0000, 245.0000, 246.0000, 247.0000, 248.0000, 249.0000, 249.8000, 250.8000, 251.8000, 252.8000, 253.8000, 254.8000,
                                      255.8000, 256.8000, 257.8000, 258.8000, 259.8000, 260.6000, 261.6000, 262.6000, 263.6000, 264.6000, 265.4000, 266.4000, 267.4000, 268.4000, 269.4000,
                                      270.2000, 271.2000, 272.2000, 273.4000, 274.6000, 275.8000, 276.8000, 277.8000, 278.8000, 280.0000, 281.0000, 282.0000, 283.0000, 284.2000, 285.4000,
                                      286.6000, 287.6000, 288.8000, 290.0000, 291.6000, 292.8000, 294.0000, 295.8000, 297.0000, 298.2000, 299.8000, 301.0000, 302.6000, 303.8000, 305.0000,
                                      306.0000, 307.4000, 308.8000, 309.8000, 311.0000, 312.0000, 313.0000, 314.4000, 315.8000, 316.8000, 318.0000, 319.0000, 320.2000, 321.2000, 322.2000,
                                      323.2000, 324.2000, 325.4000, 326.4000, 327.4000, 328.4000, 329.6000, 330.6000, 331.6000, 332.6000, 333.6000, 334.8000, 335.8000, 336.8000, 337.8000,
                                      338.8000, 339.8000, 340.8000, 341.8000, 342.8000, 343.8000, 344.8000, 345.8000, 346.8000, 347.8000, 348.8000, 349.8000, 351.0000, 352.0000, 353.0000,
                                      354.0000, 355.0000, 356.2000, 357.6000, 358.8000, 359.8000, 360.8000, 362.0000, 363.0000, 364.0000, 365.0000, 366.4000, 367.6000, 368.6000, 369.6000,
                                      370.4000, 371.2000, 372.2000, 373.0000, 374.0000, 375.0000, 376.0000, 377.0000, 377.8000, 378.8000, 379.8000, 380.8000, 381.8000, 382.8000, 383.6000,
                                      384.6000, 385.8000, 386.8000, 388.0000, 389.0000, 390.2000, 391.6000, 392.8000, 393.8000, 395.0000, 396.0000, 397.2000, 398.6000, 399.8000, 400.8000,
                                      401.8000, 402.8000, 403.6000, 404.4000, 405.4000, 406.2000, 407.2000, 408.0000, 409.0000, 410.0000, 411.0000, 412.0000, 412.8000, 413.8000, 414.8000,
                                      415.8000, 416.8000, 418.0000, 419.2000, 420.6000, 421.8000, 423.0000, 424.0000, 425.4000, 426.8000, 427.8000, 429.0000, 430.4000, 431.8000, 432.8000,
                                      433.8000, 434.8000, 435.8000, 436.8000, 438.0000, 439.0000, 440.0000, 441.0000, 442.0000, 443.0000, 444.0000, 445.0000, 446.0000, 447.2000, 448.2000,
                                      449.8000, 451.0000, 452.4000, 453.8000, 455.0000, 456.4000, 457.8000, 459.0000, 460.6000, 461.8000, 463.0000, 464.4000, 465.6000, 466.6000, 467.8000,
                                      468.8000, 469.8000, 470.8000, 471.8000, 472.8000, 473.8000, 474.8000, 475.8000, 477.0000, 478.0000, 479.0000, 480.0000, 481.2000, 482.6000, 483.8000,
                                      485.0000, 486.4000, 487.8000, 489.0000, 490.0000, 491.6000, 492.8000, 494.0000, 495.2000, 496.8000, 498.0000, 499.8000, 501.0000, 502.8000, 504.0000,
                                      505.8000, 507.0000, 508.8000, 510.2000, 511.8000, 513.0000, 514.0000, 515.0000, 516.0000, 517.0000, 518.0000, 519.2000, 520.2000, 521.4000, 522.6000,
                                      523.6000, 524.8000, 525.8000, 526.8000, 527.8000, 528.8000, 530.0000, 531.0000, 532.0000, 533.4000, 534.6000, 535.8000, 536.8000, 538.0000, 539.0000,
                                      540.0000, 541.2000, 542.4000, 543.8000, 544.8000, 545.8000, 546.8000, 547.8000, 548.8000, 549.8000, 550.8000, 551.8000, 552.8000, 553.8000, 554.8000,
                                      555.8000, 556.8000, 557.8000, 558.8000, 559.8000, 561.0000, 562.8000, 564.4000, 566.0000, 567.6000, 569.0000, 570.8000, 572.2000, 573.8000, 575.4000,
                                      576.8000, 577.8000, 578.8000, 579.8000, 580.8000, 581.8000, 582.8000, 583.8000, 584.8000, 585.8000, 586.8000, 587.8000, 588.8000, 589.8000, 590.8000,
                                      591.8000, 592.8000, 594.0000, 595.0000, 596.0000, 597.0000, 598.0000, 599.2000, 600.4000, 601.6000, 602.6000, 603.8000, 604.8000, 605.8000, 606.8000,
                                      608.0000, 609.0000, 610.0000, 611.0000, 612.0000, 613.0000, 614.0000, 615.0000, 616.0000, 617.0000, 618.2000, 619.2000, 620.2000, 621.4000, 622.4000,
                                      623.4000, 624.6000, 625.6000, 626.6000, 627.6000, 628.8000, 629.8000, 630.8000, 631.8000, 632.8000, 633.8000, 634.8000, 635.8000, 636.8000, 637.8000,
                                      638.8000, 640.0000, 640.8000, 641.8000, 642.6000, 643.4000, 644.0000, 645.0000, 646.0000, 646.8000, 647.8000, 648.6000, 649.4000, 650.0000, 651.0000,
                                      652.0000, 652.8000, 653.8000, 654.6000, 655.2000, 656.0000, 657.2000, 658.4000, 659.6000, 660.6000, 661.8000, 662.8000, 663.8000, 665.0000, 666.0000,
                                      667.0000, 668.0000, 669.2000, 670.4000, 671.4000, 672.6000, 673.6000, 674.4000, 675.4000, 676.4000, 677.2000, 678.2000, 679.2000, 680.0000, 681.0000,
                                      682.0000, 683.0000, 684.0000, 685.0000, 686.0000, 687.0000, 688.0000, 689.0000, 690.0000, 691.0000, 692.0000, 693.2000, 694.4000, 695.6000, 696.8000,
                                      697.8000, 698.8000, 699.8000, 700.8000, 702.0000, 703.0000, 704.0000, 705.0000, 706.0000, 707.0000, 708.0000, 709.0000, 710.0000, 711.0000, 712.0000,
                                      713.0000, 714.0000, 715.0000, 716.0000, 717.0000, 718.0000, 719.0000, 720.0000, 721.0000, 722.0000, 723.0000, 724.0000, 725.0000, 726.2000, 727.2000,
                                      728.2000, 729.4000, 730.4000, 731.4000, 732.4000, 733.6000, 734.6000, 735.6000, 736.8000, 738.0000, 739.8000, 741.0000, 742.4000, 743.8000, 745.2000,
                                      746.8000, 748.0000, 749.8000, 751.0000, 752.4000, 753.2000, 754.0000, 755.0000, 756.0000, 756.8000, 757.8000, 758.8000, 759.6000, 760.4000, 761.2000,
                                      762.0000, 763.0000, 764.0000, 764.8000, 765.8000, 766.8000, 767.6000, 768.8000, 770.0000, 771.6000, 773.0000, 774.4000, 775.8000, 777.2000, 778.8000,
                                      780.0000, 781.8000, 783.0000, 784.4000, 785.4000, 786.2000, 787.2000, 788.0000, 789.0000, 790.0000, 791.0000, 792.0000, 793.0000, 794.0000, 794.8000,
                                      795.8000, 796.8000, 797.8000, 798.8000, 799.8000, 800.8000, 801.8000, 802.8000, 803.8000, 805.0000, 806.0000, 807.0000, 808.0000, 809.2000, 810.4000,
                                      811.4000, 812.6000, 813.8000, 814.8000, 815.8000, 816.8000, 817.8000, 818.8000, 819.8000, 820.8000, 821.8000, 822.8000, 823.8000, 824.8000, 825.8000,
                                      826.8000, 827.8000, 828.8000, 829.8000, 830.8000, 831.8000, 832.8000, 834.0000, 835.2000, 836.6000, 837.8000, 839.0000, 840.0000, 841.4000, 842.8000,
                                      843.8000, 845.0000, 846.2000, 847.6000, 848.8000, 850.0000, 851.6000, 852.8000, 854.0000, 855.8000, 857.0000, 858.2000, 859.8000, 861.0000, 862.2000,
                                      863.8000, 864.8000, 865.8000, 867.0000, 868.0000, 869.0000, 870.0000, 871.0000, 872.0000, 873.0000, 874.0000, 875.0000, 876.2000, 877.2000, 878.4000,
                                      879.4000, 880.4000, 881.2000, 882.0000, 883.0000, 884.0000, 885.0000, 885.8000, 886.8000, 887.8000, 888.8000, 889.6000, 890.4000, 891.2000, 892.0000,
                                      893.0000, 894.0000, 895.0000, 895.8000, 896.8000, 898.0000, 899.0000, 900.0000, 901.2000, 902.4000, 903.6000, 904.8000, 905.8000, 906.8000, 908.0000,
                                      909.0000, 910.0000, 911.0000, 912.2000, 913.4000, 914.6000, 915.8000, 916.8000, 917.8000, 918.8000, 920.0000, 921.0000, 922.0000, 923.0000, 924.2000,
                                      925.4000, 926.6000, 927.8000, 928.8000, 929.8000, 930.8000, 932.0000, 933.0000, 934.0000, 935.0000, 936.2000, 937.4000, 938.6000, 939.8000, 940.8000,
                                      941.8000, 942.8000, 944.0000, 945.0000, 946.0000, 947.2000, 948.4000, 949.4000, 950.6000, 951.8000, 952.8000, 953.8000, 955.0000, 956.0000, 957.0000,
                                      958.0000, 959.2000, 960.4000, 961.4000, 962.2000, 963.2000, 964.2000, 965.2000, 966.0000, 967.0000, 968.0000, 969.0000, 970.0000, 971.0000, 972.0000,
                                      973.0000, 974.0000, 975.0000, 976.0000, 977.0000, 978.0000, 979.4000, 980.8000, 981.8000, 982.8000, 984.0000, 985.0000, 986.4000, 987.6000, 988.8000,
                                      989.8000, 991.0000, 992.0000, 993.0000, 994.2000, 995.2000, 996.4000, 997.4000, 998.6000, 999.6000, 1000.8000, 1001.8000, 1002.8000, 1003.8000, 1004.8000,
                                      1005.8000, 1006.8000, 1008.0000, 1012.2000, 1017.8000, 1023.2000, 1025.0000, 1025.8000, 1026.8000, 1027.6000, 1028.4000, 1029.0000, 1030.0000, 1031.0000, 1031.8000,
                                      1032.8000, 1033.6000, 1034.4000, 1035.0000, 1036.0000, 1037.0000, 1037.8000, 1038.8000, 1039.6000, 1040.4000, 1041.8000, 1042.8000, 1043.8000, 1044.8000, 1046.0000,
                                      1047.0000, 1048.0000, 1049.2000, 1050.4000, 1051.6000, 1052.8000, 1053.8000, 1054.8000, 1056.0000, 1057.0000, 1058.4000, 1059.8000, 1060.8000, 1062.0000, 1063.2000,
                                      1064.8000, 1065.8000, 1067.0000, 1068.2000, 1069.6000, 1070.8000, 1072.0000, 1073.0000, 1074.0000, 1075.0000, 1076.0000, 1076.8000, 1077.8000, 1078.8000, 1079.8000,
                                      1080.8000, 1081.8000, 1082.8000, 1083.8000, 1084.8000, 1085.8000, 1086.8000, 1087.8000, 1088.8000, 1089.6000, 1090.4000, 1091.4000, 1092.2000, 1093.0000, 1094.0000,
                                      1095.0000, 1096.0000, 1097.0000, 1097.8000, 1098.8000, 1099.8000, 1100.8000, 1101.6000, 1102.6000, 1103.4000, 1104.4000, 1105.8000, 1107.4000, 1108.8000, 1110.2000,
                                      1111.8000, 1113.2000, 1114.8000, 1116.0000, 1117.8000, 1119.0000, 1120.6000, 1121.6000, 1122.4000, 1123.4000, 1124.4000, 1125.2000, 1126.2000, 1127.2000, 1128.0000,
                                      1129.0000, 1130.0000, 1131.0000, 1132.0000, 1133.0000, 1134.0000, 1135.0000, 1136.0000, 1137.0000, 1138.0000, 1139.0000, 1140.0000, 1141.2000, 1142.2000, 1143.4000,
                                      1144.4000, 1145.6000, 1146.6000, 1147.8000, 1148.8000, 1149.8000, 1150.8000, 1151.8000, 1153.0000, 1154.0000, 1155.0000, 1156.4000, 1157.8000, 1158.8000, 1159.8000,
                                      1161.0000, 1162.0000, 1163.2000, 1164.6000, 1165.8000, 1166.8000, 1168.0000, 1168.8000, 1169.8000, 1170.8000, 1171.8000, 1172.6000, 1173.4000, 1174.2000, 1175.2000,
                                      1176.0000, 1177.0000, 1178.0000, 1178.8000, 1179.8000, 1180.8000, 1181.8000, 1182.6000, 1183.4000, 1184.4000, 1185.6000, 1186.8000, 1188.0000, 1189.0000, 1190.2000,
                                      1191.6000, 1192.8000, 1193.8000, 1195.0000, 1196.0000, 1197.4000, 1198.6000, 1199.8000, 1200.8000, 1201.6000, 1202.2000, 1203.0000, 1204.0000, 1204.8000, 1205.6000,
                                      1206.2000, 1207.0000, 1208.0000, 1208.8000, 1209.6000, 1210.4000, 1211.0000, 1212.0000, 1212.8000, 1213.8000, 1214.4000, 1215.0000, 1216.0000, 1217.0000, 1218.2000,
                                      1219.6000, 1220.8000, 1221.8000, 1223.0000, 1224.2000, 1225.4000, 1226.8000, 1227.8000, 1229.0000, 1230.0000, 1231.4000, 1232.8000, 1233.8000, 1234.8000, 1235.8000,
                                      1236.8000, 1237.8000, 1238.8000, 1239.8000, 1240.8000, 1241.8000, 1242.8000, 1244.0000, 1245.0000, 1246.0000, 1247.0000, 1248.0000, 1249.0000, 1250.0000, 1251.2000,
                                      1252.4000, 1253.8000, 1254.8000, 1255.8000, 1256.8000, 1258.0000, 1259.0000, 1260.0000, 1261.2000, 1262.4000, 1263.6000, 1264.6000, 1265.6000, 1266.4000, 1267.2000,
                                      1268.2000, 1269.0000, 1270.0000, 1271.0000, 1272.0000, 1272.8000, 1273.8000, 1274.8000, 1275.8000, 1276.8000, 1277.6000, 1278.6000, 1279.4000, 1280.4000, 1281.6000,
                                      1282.8000, 1283.8000, 1284.8000, 1285.8000, 1287.0000, 1288.0000, 1289.0000, 1290.2000, 1291.4000, 1292.6000, 1293.8000, 1294.8000, 1295.8000, 1296.8000, 1297.8000,
                                      1298.8000, 1299.8000, 1300.8000, 1301.8000, 1302.8000, 1303.8000, 1305.0000, 1306.0000, 1307.0000, 1308.0000, 1309.0000, 1310.0000, 1311.0000, 1312.0000, 1313.0000,
                                      1314.0000, 1315.0000, 1316.0000, 1317.0000, 1318.2000, 1319.2000, 1320.4000, 1321.4000, 1322.6000, 1323.6000, 1324.8000, 1325.8000, 1326.8000, 1327.8000, 1329.0000,
                                      1330.0000, 1331.6000, 1332.8000, 1334.0000, 1335.2000, 1336.6000, 1337.8000, 1339.0000, 1340.2000, 1341.8000, 1342.8000, 1344.0000, 1345.0000, 1346.0000, 1347.0000,
                                      1348.0000, 1348.8000, 1349.8000, 1350.8000, 1351.8000, 1352.8000, 1353.6000, 1354.6000, 1355.4000, 1356.2000, 1357.2000, 1358.0000, 1359.0000, 1360.0000, 1361.0000,
                                      1362.0000, 1363.2000, 1364.4000, 1365.6000, 1366.6000, 1367.8000, 1368.8000, 1369.8000, 1370.8000, 1372.0000, 1373.0000, 1374.0000, 1375.0000, 1376.0000, 1377.2000,
                                      1378.2000, 1379.4000, 1380.4000, 1381.6000, 1382.6000, 1383.8000, 1384.8000, 1385.8000, 1386.8000, 1387.8000, 1388.8000, 1389.8000, 1391.0000, 1392.0000, 1393.0000,
                                      1394.0000, 1395.0000, 1396.0000, 1397.0000, 1398.0000, 1399.0000, 1400.0000, 1401.0000, 1402.0000, 1403.2000, 1404.2000, 1405.2000, 1406.2000, 1407.4000, 1408.4000,
                                      1409.4000, 1410.6000, 1411.6000, 1412.8000, 1413.8000, 1414.8000, 1415.8000, 1416.8000, 1417.8000, 1418.8000, 1420.0000, 1421.0000, 1422.0000, 1423.0000, 1424.0000,
                                      1425.2000, 1426.4000, 1427.6000, 1428.8000, 1429.8000, 1430.8000, 1432.0000, 1433.0000, 1434.0000, 1435.0000, 1436.4000, 1437.6000, 1438.8000, 1439.8000, 1440.8000,
                                      1441.8000, 1442.8000, 1443.8000, 1444.8000, 1445.8000, 1446.6000, 1447.6000, 1448.4000, 1449.4000, 1450.4000, 1451.2000, 1452.2000, 1453.2000, 1454.0000, 1455.0000,
                                      1456.0000, 1457.8000, 1459.0000, 1460.2000, 1461.8000, 1463.0000, 1464.6000, 1466.0000, 1467.2000, 1468.8000, 1470.0000, 1471.6000, 1472.8000, 1473.8000, 1475.0000,
                                      1476.0000, 1477.0000, 1478.0000, 1479.2000, 1480.4000, 1481.6000, 1482.8000, 1483.8000, 1484.8000, 1485.8000, 1487.0000, 1488.0000, 1489.0000, 1490.0000, 1491.0000,
                                      1492.0000, 1493.0000, 1494.0000, 1495.0000, 1496.0000, 1497.0000, 1498.0000, 1499.0000, 1500.0000, 1501.0000, 1501.8000, 1502.8000, 1503.8000, 1504.8000, 1505.8000,
                                      1506.8000, 1507.8000, 1508.8000, 1509.8000, 1510.8000, 1511.6000, 1512.6000, 1513.4000, 1514.4000, 1515.2000, 1516.2000, 1517.2000, 1518.0000, 1519.0000, 1520.0000,
                                      1522.8000, 1525.0000, 1527.8000, 1530.6000, 1533.0000, 1535.8000, 1537.0000, 1538.0000, 1539.0000, 1540.0000, 1541.0000, 1542.0000, 1543.0000, 1544.0000, 1545.0000,
                                      1546.0000, 1547.0000, 1548.0000, 1549.0000, 1550.0000, 1551.0000, 1552.0000, 1553.2000, 1554.4000, 1555.6000, 1556.8000, 1557.8000, 1558.8000, 1559.8000, 1561.0000,
                                      1562.0000, 1563.0000, 1564.2000, 1565.4000, 1566.6000, 1567.8000, 1568.8000, 1570.0000, 1571.4000, 1572.8000, 1574.0000, 1575.2000, 1576.8000, 1577.8000, 1579.0000,
                                      1580.6000, 1581.8000, 1583.0000, 1584.2000, 1585.0000, 1586.0000, 1586.8000, 1587.8000, 1588.6000, 1589.2000, 1590.0000, 1591.0000, 1591.8000, 1592.8000, 1593.6000,
                                      1594.2000, 1595.0000, 1596.0000, 1596.8000, 1597.8000, 1598.6000, 1599.2000, 1600.0000, 1601.0000, 1602.2000, 1603.2000, 1604.4000, 1605.4000, 1606.6000, 1607.6000,
                                      1608.8000, 1609.8000, 1610.8000, 1611.8000, 1612.8000, 1613.8000, 1615.0000, 1616.0000, 1617.0000, 1618.0000, 1619.4000, 1620.6000, 1621.8000, 1622.8000, 1624.0000,
                                      1625.0000, 1626.2000, 1627.4000, 1628.8000, 1629.8000, 1630.8000, 1632.0000, 1633.0000, 1634.2000, 1635.6000, 1636.8000, 1637.8000, 1639.0000, 1640.0000, 1641.2000,
                                      1642.6000, 1643.8000, 1644.8000, 1646.0000, 1647.0000, 1648.2000, 1649.2000, 1650.2000, 1651.0000, 1652.0000, 1653.0000, 1654.0000, 1655.0000, 1656.0000, 1657.0000,
                                      1658.0000, 1659.0000, 1660.0000, 1661.0000, 1662.0000, 1663.0000, 1664.0000, 1665.0000, 1666.0000, 1667.2000, 1668.4000, 1669.6000, 1670.8000, 1671.8000, 1672.8000,
                                      1673.8000, 1675.0000, 1676.0000, 1677.0000, 1678.0000, 1679.2000, 1680.2000, 1681.4000, 1682.4000, 1683.6000, 1684.6000, 1685.8000, 1686.8000, 1687.8000, 1688.8000,
                                      1689.8000, 1690.8000, 1691.8000, 1692.8000, 1694.0000, 1695.0000, 1696.0000, 1697.0000, 1698.2000, 1699.4000, 1700.6000, 1701.8000, 1702.8000, 1704.0000, 1705.0000,
                                      1706.0000, 1707.2000, 1708.6000, 1709.8000, 1710.8000, 1711.8000, 1713.0000, 1713.8000, 1714.8000, 1715.8000, 1716.8000, 1717.8000, 1718.8000, 1719.8000, 1720.8000,
                                      1721.8000, 1722.8000, 1723.8000, 1724.8000, 1725.8000, 1726.8000, 1727.8000, 1728.8000, 1729.8000, 1731.0000, 1732.0000, 1733.2000, 1734.4000, 1735.8000, 1736.8000,
                                      1738.0000, 1739.0000, 1740.0000, 1741.4000, 1742.8000, 1743.8000, 1744.8000, 1745.8000, 1746.8000, 1748.0000, 1749.0000, 1750.0000, 1751.0000, 1752.0000, 1753.0000,
                                      1754.0000, 1755.0000, 1756.0000, 1757.0000, 1758.0000, 1759.0000, 1760.2000, 1761.0000, 1761.8000, 1762.8000, 1763.4000, 1764.0000, 1765.0000, 1765.8000, 1766.6000,
                                      1767.2000, 1768.0000, 1768.8000, 1769.8000, 1770.4000, 1771.0000, 1772.0000, 1772.8000, 1773.6000, 1774.2000, 1775.0000, 1775.8000, 1776.8000, 1777.8000, 1778.6000,
                                      1779.4000, 1780.2000, 1781.0000, 1782.0000, 1783.0000, 1783.8000, 1784.8000, 1785.8000, 1786.6000, 1787.4000, 1788.2000, 1789.0000, 1790.0000, 1791.0000, 1791.8000,
                                      1793.0000, 1794.0000, 1795.2000, 1796.6000, 1797.8000, 1799.0000, 1800.0000, 1801.2000, 1802.6000, 1803.8000, 1804.8000, 1806.0000, 1807.0000, 1808.4000, 1809.8000,
                                      1811.0000, 1812.0000, 1813.4000, 1814.8000, 1816.0000, 1817.0000, 1818.6000, 1819.8000, 1821.0000, 1822.0000, 1823.6000, 1824.8000, 1825.8000, 1826.8000, 1828.0000,
                                      1829.0000, 1830.0000, 1831.2000, 1832.4000, 1833.6000, 1834.8000, 1835.8000, 1836.8000, 1837.8000, 1839.0000, 1840.0000, 1841.0000, 1842.4000, 1843.6000, 1844.8000,
                                      1845.8000, 1847.0000, 1848.0000, 1849.2000, 1850.6000, 1851.8000, 1852.8000, 1854.0000, 1855.0000, 1856.0000, 1857.2000, 1858.2000, 1859.4000, 1860.4000, 1861.6000,
                                      1862.6000, 1863.8000, 1864.8000, 1865.8000, 1866.8000, 1867.8000, 1868.8000, 1869.8000, 1870.8000, 1872.0000, 1873.0000, 1874.0000, 1875.0000, 1876.0000, 1877.0000,
                                      1878.0000, 1879.0000, 1880.0000, 1881.0000, 1882.0000, 1883.0000, 1884.0000, 1885.0000, 1886.2000, 1887.2000, 1888.2000, 1889.2000, 1890.2000, 1891.2000, 1892.2000,
                                      1893.2000, 1894.2000, 1895.2000, 1896.2000, 1897.2000, 1898.2000, 1899.2000, 1900.2000, 1901.2000, 1902.2000, 1903.2000, 1904.4000, 1905.4000, 1906.6000, 1907.8000,
                                      1908.8000, 1909.8000, 1910.8000, 1912.0000, 1913.0000, 1914.0000, 1915.0000, 1916.0000, 1917.2000, 1918.4000, 1919.6000, 1920.6000, 1921.6000, 1922.6000, 1923.6000,
                                      1924.6000, 1925.6000, 1926.6000, 1927.6000, 1928.6000, 1929.6000, 1930.4000, 1931.4000, 1932.4000, 1933.4000, 1934.4000, 1935.4000, 1936.6000, 1937.8000, 1939.0000,
                                      1940.8000, 1942.0000, 1943.2000, 1944.8000, 1946.0000, 1947.4000, 1948.8000, 1950.0000, 1951.6000, 1952.8000, 1953.8000, 1954.8000, 1955.8000, 1957.0000, 1958.0000,
                                      1959.0000, 1960.0000, 1961.0000, 1962.0000, 1963.0000, 1964.0000, 1965.2000, 1966.2000, 1967.2000, 1968.4000, 1969.8000, 1970.8000, 1971.8000, 1973.0000, 1974.0000,
                                      1975.2000, 1976.6000, 1977.8000, 1978.8000, 1980.0000, 1981.0000, 1982.0000, 1983.4000, 1984.6000, 1985.4000, 1986.2000, 1987.0000, 2049.0000, 2047.4000, 1990.0000,
                                      2046.8000, 2052.6001, 2053.3999, 2054.0000, 1994.6000, 1995.6000, 1996.4000, 1997.2000, 2058.3999, 2059.0000, 2060.0000, 2001.0000, 2002.4000, 2003.6000, 2063.3999,
                                      2064.2000, 2040.8000, 2067.6001, 2009.4000, 2010.8000, 2072.2000, 2073.8000, 2075.6001, 2015.2000, 2078.8000, 2037.0000, 2081.0000, 2082.0000, 2083.0000, 2084.0000,
                                      2035.2000, 2024.0000, 2025.2000, 2026.4000, 2027.6000, 2028.8000, 2029.8000, 2091.8000, 2032.2000, 2093.8000, 2094.8000, 2095.6001, 2096.6001, 2097.8000, 2098.8000,
                                      2100.0000, 2101.0000, 2102.2000, 2103.6001, 2104.8000, 2105.8000, 2107.0000, 2108.0000, 2109.0000, 2110.3999, 2111.8000, 2112.8000, 2114.0000, 2115.0000, 2116.2000,
                                      2117.6001, 2118.8000, 2119.8000, 2121.0000, 2122.0000, 2123.3999, 2124.8000, 2125.8000, 2127.0000, 2128.0000, 2129.0000, 2130.2000, 2131.2000, 2132.3999, 2133.3999,
                                      2134.6001, 2135.8000, 2136.8000, 2137.8000, 2138.8000, 2139.8000, 2140.8000, 2141.8000, 2143.0000, 2144.0000, 2145.0000, 2146.2000, 2147.3999, 2148.6001, 2149.8000,
                                      2150.8000, 2152.0000, 2153.0000, 2154.0000, 2155.2000, 2156.6001, 2157.8000, 2158.8000, 2159.8000, 2160.8000, 2161.8000, 2162.6001, 2163.3999, 2164.2000, 2165.0000,
                                      2166.0000, 2166.8000, 2167.8000, 2168.8000, 2169.6001, 2170.2000, 2171.0000, 2172.0000, 2173.0000, 2173.8000, 2174.8000, 2175.6001, 2176.6001, 2177.8000, 2178.8000,
                                      2179.8000, 2180.8000, 2182.0000, 2183.0000, 2184.0000, 2185.0000, 2186.2000, 2187.3999, 2188.6001, 2189.8000, 2190.8000, 2191.8000, 2192.8000, 2194.0000, 2195.0000,
                                      2196.0000, 2197.2000, 2198.3999, 2199.6001, 2200.8000, 2201.8000, 2202.8000, 2204.0000, 2205.0000, 2206.0000, 2207.2000, 2208.3999, 2209.6001, 2210.8000, 2211.8000,
                                      2212.8000, 2214.0000, 2215.0000, 2216.0000, 2217.2000, 2218.3999, 2219.8000, 2220.8000, 2221.8000, 2223.0000, 2224.0000, 2225.0000, 2226.3999, 2227.8000, 2228.8000,
                                      2230.0000, 2231.0000, 2232.2000, 2233.6001, 2234.8000, 2235.8000, 2237.0000, 2238.0000, 2239.3999, 2240.8000, 2241.8000, 2243.0000, 2244.2000, 2245.6001, 2246.8000,
                                      2248.0000, 2249.0000, 2250.2000, 2251.8000, 2252.8000, 2254.0000, 2255.0000, 2256.3999, 2257.0000, 2258.0000, 2258.8000, 2259.8000, 2260.6001, 2261.2000, 2262.0000,
                                      2263.0000, 2263.8000, 2264.8000, 2265.6001, 2266.2000, 2267.0000, 2268.0000, 2268.8000, 2269.8000, 2270.6001, 2271.2000, 2272.0000, 2273.6001, 2274.8000, 2276.0000,
                                      2277.8000, 2279.0000, 2280.2000, 2281.8000, 2283.0000, 2284.6001, 2285.8000, 2287.0000, 2288.6001, 2289.2000, 2290.0000, 2291.0000, 2292.0000, 2292.8000, 2293.8000,
                                      2294.8000, 2295.6001, 2296.2000, 2297.0000, 2298.0000, 2299.0000, 2299.8000, 2300.8000, 2301.8000, 2302.6001, 2303.3999, 2304.2000, 2305.8000, 2307.0000, 2308.8000,
                                      2310.0000, 2311.6001, 2313.0000, 2314.3999, 2315.8000, 2317.2000, 2318.8000, 2320.0000, 2321.0000, 2321.8000, 2322.8000, 2323.3999, 2324.2000, 2325.0000, 2326.0000,
                                      2326.8000, 2327.6001, 2328.3999, 2329.0000, 2330.0000, 2330.8000, 2331.8000, 2332.3999, 2333.2000, 2334.0000, 2334.8000, 2335.8000, 2336.8000, 2337.8000, 2338.8000,
                                      2340.0000, 2341.0000, 2342.0000, 2343.2000, 2344.3999, 2345.6001, 2346.8000, 2347.8000, 2348.8000, 2350.0000, 2351.0000, 2352.0000, 2353.3999, 2354.8000, 2355.8000,
                                      2357.0000, 2358.0000, 2359.3999, 2360.8000, 2361.8000, 2363.0000, 2364.2000, 2365.6001, 2366.8000, 2367.8000, 2368.8000, 2369.8000, 2370.6001, 2371.3999, 2372.2000,
                                      2373.0000, 2374.0000, 2374.8000, 2375.8000, 2376.8000, 2377.6001, 2378.2000, 2379.0000, 2380.0000, 2381.0000, 2381.8000, 2382.8000, 2383.6001, 2384.3999, 2385.6001,
                                      2386.6001, 2387.6001, 2388.8000, 2389.8000, 2390.8000, 2391.8000, 2392.8000, 2393.8000, 2394.8000, 2395.8000, 2396.8000, 2397.8000, 2398.8000, 2400.0000, 2401.0000,
                                      2402.2000, 2403.8000, 2404.8000, 2406.0000, 2407.2000, 2408.6001, 2409.8000, 2411.0000, 2412.0000, 2413.3999, 2414.8000, 2415.8000, 2416.8000, 2417.8000, 2418.8000,
                                      2419.8000, 2420.8000, 2421.6001, 2422.6001, 2423.3999, 2424.2000, 2425.2000, 2426.0000, 2427.0000, 2428.0000, 2429.0000, 2430.0000, 2430.8000, 2431.8000, 2432.8000,
                                      2434.0000, 2435.0000, 2436.3999, 2437.8000, 2438.8000, 2440.0000, 2441.0000, 2442.2000, 2443.6001, 2444.8000, 2446.0000, 2447.0000, 2448.2000, 2449.2000, 2450.2000,
                                      2451.2000, 2452.2000, 2453.2000, 2454.2000, 2455.2000, 2456.2000, 2457.2000, 2458.2000, 2459.2000, 2460.2000, 2461.2000, 2462.2000, 2463.2000, 2464.2000, 2465.3999,
                                      2466.6001, 2467.8000, 2468.8000, 2470.0000, 2471.0000, 2472.0000, 2473.2000, 2474.3999, 2475.8000, 2476.8000, 2477.8000, 2479.0000, 2480.0000, 2481.2000, 2482.8000,
                                      2483.8000, 2485.0000, 2486.3999, 2487.8000, 2489.0000, 2490.0000, 2491.6001, 2492.8000, 2494.0000, 2495.2000, 2496.6001, 2497.6001, 2498.3999, 2499.3999, 2500.2000,
                                      2501.2000, 2502.0000, 2503.0000, 2504.0000, 2505.0000, 2506.0000, 2507.0000, 2508.0000, 2508.8000, 2509.8000, 2510.8000, 2511.8000, 2512.8000, 2514.0000, 2515.0000,
                                      2516.2000, 2517.6001, 2518.8000, 2519.8000, 2521.0000, 2522.0000, 2523.3999, 2524.8000, 2525.8000, 2527.0000, 2528.0000, 2529.0000, 2530.0000, 2531.0000, 2532.0000,
                                      2532.8000, 2533.8000, 2534.8000, 2535.8000, 2536.8000, 2537.8000, 2538.8000, 2539.6001, 2540.6001, 2541.3999, 2542.3999, 2543.2000, 2544.2000, 2546.8000, 2549.0000,
                                      2551.8000, 2554.0000, 2556.8000, 2559.0000, 2560.8000, 2561.8000, 2562.8000, 2564.0000, 2565.0000, 2566.0000, 2567.0000, 2568.0000, 2569.0000, 2570.2000, 2571.2000,
                                      2572.3999, 2573.3999, 2574.6001, 2575.6001, 2576.8000, 2577.8000, 2578.8000, 2579.8000, 2580.8000, 2581.8000, 2582.8000, 2584.0000, 2585.0000, 2586.0000, 2587.0000,
                                      2588.0000, 2589.0000, 2590.0000, 2591.2000, 2592.2000, 2593.6001, 2594.8000, 2596.0000, 2597.0000, 2598.3999, 2599.8000, 2601.0000, 2602.0000, 2603.3999, 2604.8000,
                                      2605.8000, 2607.0000, 2608.0000, 2609.0000, 2610.0000, 2611.0000, 2611.8000, 2612.8000, 2613.8000, 2614.8000, 2615.6001, 2616.6001, 2617.3999, 2618.2000, 2619.0000,
                                      2620.0000, 2621.0000, 2622.0000, 2622.8000, 2623.8000, 2624.8000, 2626.0000, 2627.6001, 2628.8000, 2630.0000, 2631.6001, 2632.8000, 2634.0000, 2635.3999, 2636.8000,
                                      2638.0000, 2639.3999, 2640.8000, 2641.8000, 2642.8000, 2643.8000, 2644.8000, 2645.8000, 2647.0000, 2648.0000, 2649.0000, 2650.0000, 2651.0000, 2652.0000, 2653.0000,
                                      2654.0000, 2655.2000, 2656.2000, 2657.6001, 2658.8000, 2659.8000, 2660.8000, 2662.0000, 2663.0000, 2664.2000, 2665.3999, 2666.6001, 2667.8000, 2668.8000, 2670.0000,
                                      2671.0000, 2672.0000, 2673.0000, 2673.8000, 2674.8000, 2675.6001, 2676.2000, 2677.0000, 2678.0000, 2678.8000, 2679.8000, 2680.3999, 2681.0000, 2682.0000, 2682.8000,
                                      2683.8000, 2684.6001, 2685.2000, 2686.0000, 2687.0000, 2687.8000, 2688.8000, 2690.0000, 2691.6001, 2692.8000, 2694.0000, 2695.6001, 2696.8000, 2698.0000, 2699.6001,
                                      2700.8000, 2702.0000, 2703.8000, 2704.8000, 2705.8000, 2706.8000, 2707.8000, 2708.8000, 2710.0000, 2711.0000, 2712.0000, 2713.0000, 2714.0000, 2715.0000, 2716.0000,
                                      2717.0000, 2718.0000, 2719.2000, 2720.2000, 2721.6001, 2722.8000, 2723.8000, 2725.0000, 2726.0000, 2727.0000, 2728.3999, 2729.6001, 2730.8000, 2731.8000, 2733.0000,
                                      2734.0000, 2735.2000, 2736.3999, 2737.8000, 2738.8000, 2740.0000, 2741.0000, 2742.2000, 2743.3999, 2744.8000, 2745.8000, 2747.0000, 2748.0000, 2749.2000, 2750.3999,
                                      2751.8000, 2752.8000, 2753.8000, 2755.0000, 2756.0000, 2757.0000, 2758.0000, 2759.0000, 2760.2000, 2761.3999, 2762.6001, 2763.8000, 2764.8000, 2765.8000, 2766.8000,
                                      2768.0000, 2769.0000, 2770.0000, 2771.0000, 2771.8000, 2772.8000, 2773.8000, 2774.8000, 2775.8000, 2776.8000, 2777.8000, 2778.8000, 2779.8000, 2780.8000, 2781.8000,
                                      2782.8000, 2783.8000, 2784.8000, 2786.0000, 2787.0000, 2788.2000, 2789.3999, 2790.8000, 2791.8000, 2793.0000, 2794.0000, 2795.0000, 2796.3999, 2797.6001, 2798.8000,
                                      2799.8000, 2800.8000, 2801.8000, 2802.8000, 2803.8000, 2804.6001, 2805.6001, 2806.3999, 2807.2000, 2808.0000, 2809.0000, 2810.0000, 2811.0000, 2812.0000, 2812.8000,
                                      2813.8000, 2814.8000, 2815.8000, 2816.8000, 2817.8000, 2818.8000, 2819.8000, 2821.0000, 2822.0000, 2823.0000, 2824.0000, 2825.0000, 2826.2000, 2827.2000, 2828.3999,
                                      2829.6001, 2830.6001, 2831.8000, 2832.8000, 2833.8000, 2834.8000, 2835.8000, 2836.8000, 2837.8000, 2838.8000, 2840.0000, 2841.0000, 2842.0000, 2843.0000, 2844.0000,
                                      2845.0000, 2846.0000, 2847.0000, 2848.0000, 2849.0000, 2850.0000, 2851.0000, 2852.0000, 2853.0000, 2854.0000, 2855.0000, 2856.0000, 2857.0000, 2858.0000, 2859.0000,
                                      2860.0000, 2861.0000, 2862.0000, 2863.0000, 2864.0000, 2865.0000, 2866.8000, 2868.0000, 2869.2000, 2870.8000, 2872.0000, 2873.3999, 2874.8000, 2876.0000, 2877.6001,
                                      2878.8000, 2880.0000, 2881.0000, 2882.0000, 2883.0000, 2883.8000, 2884.8000, 2885.8000, 2886.8000, 2887.6001, 2888.3999, 2889.2000, 2890.0000, 2891.0000, 2892.0000,
                                      2892.8000, 2893.8000, 2894.8000, 2895.8000, 2896.8000, 2897.8000, 2899.0000, 2900.2000, 2901.8000, 2902.8000, 2904.0000, 2905.2000, 2906.8000, 2907.8000, 2909.0000,
                                      2910.2000, 2911.8000, 2912.8000, 2913.6001, 2914.3999, 2915.0000, 2916.0000, 2917.0000, 2917.8000, 2918.8000, 2919.6001, 2920.3999, 2921.0000, 2922.0000, 2923.0000,
                                      2923.8000, 2924.8000, 2925.6001, 2926.3999, 2927.2000, 2928.0000, 2929.0000, 2929.8000, 2930.8000, 2931.3999, 2932.2000, 2933.0000, 2934.0000, 2934.8000, 2935.8000,
                                      2936.3999, 2937.0000, 2938.0000, 2939.0000, 2939.8000, 2940.8000, 2941.3999, 2942.0000, 2943.0000, 2943.8000, 2944.8000, 2946.0000, 2947.0000, 2948.0000, 2949.2000,
                                      2950.3999, 2951.6001, 2952.8000, 2953.8000, 2954.8000, 2956.0000, 2957.0000, 2958.0000, 2959.0000, 2960.2000, 2961.2000, 2962.0000, 2963.0000, 2964.0000, 2965.0000,
                                      2966.0000, 2967.0000, 2967.8000, 2968.8000, 2969.8000, 2970.8000, 2971.8000, 2972.8000, 2973.6001, 2974.6001, 2975.3999, 2976.3999, 2977.3999, 2978.6001, 2979.6001,
                                      2980.8000, 2981.8000, 2982.8000, 2983.8000, 2984.8000, 2985.8000, 2986.8000, 2987.8000, 2989.0000, 2990.0000, 2991.0000, 2992.0000, 2993.3999, 2994.8000, 2996.2000,
                                      2997.8000, 2999.0000, 3000.6001, 3001.8000, 3003.2000, 3004.8000, 3006.0000, 3007.6001, 3008.8000, 3009.6001, 3010.2000, 3011.0000, 3012.0000, 3013.0000, 3013.8000,
                                      3014.8000, 3015.6001, 3016.3999, 3017.2000, 3018.0000, 3019.0000, 3019.8000, 3020.8000, 3021.8000, 3022.6001, 3023.2000, 3024.0000, 3025.2000, 3026.6001, 3027.8000,
                                      3028.8000, 3030.0000, 3031.0000, 3032.3999, 3033.6001, 3034.8000, 3035.8000, 3037.0000, 3038.0000, 3039.3999, 3040.6001, 3041.8000, 3042.8000, 3043.8000, 3044.8000,
                                      3045.8000, 3047.0000, 3048.0000, 3049.0000, 3050.0000, 3051.0000, 3052.0000, 3053.2000, 3054.3999, 3055.3999, 3056.8000, 3059.2000, 3061.8000, 3064.0000, 3066.8000,
                                      3069.0000, 3071.3999, 3072.8000, 3073.8000, 3074.8000, 3075.8000, 3076.8000, 3077.8000, 3078.8000, 3079.8000, 3080.8000, 3081.8000, 3082.8000, 3083.8000, 3084.8000,
                                      3085.8000, 3086.8000, 3087.8000, 3088.8000, 3089.8000, 3090.8000, 3092.0000, 3093.0000, 3094.0000, 3095.0000, 3096.2000, 3097.3999, 3098.6001, 3099.8000, 3100.8000,
                                      3101.8000, 3102.8000, 3104.0000, 3105.0000, 3106.0000, 3107.0000, 3108.0000, 3109.0000, 3110.0000, 3111.0000, 3112.0000, 3113.0000, 3114.2000, 3115.2000, 3116.2000,
                                      3117.3999, 3118.3999, 3119.3999, 3120.6001, 3121.8000, 3123.0000, 3124.0000, 3125.2000, 3126.6001, 3127.8000, 3129.0000, 3130.0000, 3131.3999, 3132.8000, 3133.8000,
                                      3135.0000, 3136.0000, 3137.0000, 3138.0000, 3139.0000, 3140.0000, 3141.0000, 3141.8000, 3142.8000, 3143.8000, 3144.8000, 3145.8000, 3146.8000, 3147.8000, 3148.6001,
                                      3149.6001, 3150.3999, 3151.3999, 3152.2000, 3153.0000, 3154.0000, 3155.0000, 3156.0000, 3156.8000, 3157.8000, 3158.8000, 3159.8000, 3160.8000, 3161.6001, 3162.3999,
                                      3163.2000, 3164.0000, 3165.0000, 3166.0000, 3167.0000, 3167.8000, 3169.0000, 3170.0000, 3171.2000, 3172.6001, 3173.8000, 3174.8000, 3176.0000, 3177.0000, 3178.2000,
                                      3179.3999, 3180.8000, 3181.8000, 3183.0000, 3184.0000, 3185.0000, 3185.8000, 3186.8000, 3187.8000, 3188.6001, 3189.2000, 3190.0000, 3191.0000, 3192.0000, 3192.8000,
                                      3193.8000, 3194.6001, 3195.3999, 3196.2000, 3197.0000, 3198.0000, 3199.0000, 3199.8000, 3200.8000, 3201.8000, 3202.8000, 3203.8000, 3204.6001, 3205.6001, 3206.3999,
                                      3207.3999, 3208.3999, 3209.2000, 3210.2000, 3211.0000, 3212.0000, 3213.0000, 3214.0000, 3215.0000, 3216.0000, 3217.0000, 3217.8000, 3218.8000, 3219.8000, 3220.6001,
                                      3221.3999, 3222.2000, 3223.0000, 3224.0000, 3225.0000, 3225.8000, 3226.8000, 3227.8000, 3228.6001, 3229.3999, 3230.2000, 3231.0000, 3232.0000, 3233.0000, 3234.6001,
                                      3235.8000, 3237.0000, 3238.0000, 3239.6001, 3240.8000, 3242.0000, 3243.0000, 3244.3999, 3245.8000, 3247.0000, 3248.0000, 3249.0000, 3250.0000, 3251.0000, 3252.0000,
                                      3253.0000, 3254.0000, 3255.0000, 3256.0000, 3257.0000, 3257.8000, 3258.8000, 3259.8000, 3260.8000, 3261.8000, 3262.8000, 3263.8000, 3264.8000, 3265.8000, 3266.8000,
                                      3267.8000, 3268.6001, 3269.6001, 3270.3999, 3271.3999, 3272.3999, 3273.2000, 3274.2000, 3275.2000, 3276.0000, 3277.0000, 3278.0000, 3279.0000, 3280.0000, 3280.8000,
                                      3281.8000, 3282.6001, 3283.2000, 3284.0000, 3285.0000, 3285.8000, 3286.8000, 3287.3999, 3288.0000, 3289.0000, 3289.8000, 3290.8000, 3291.3999, 3292.0000, 3293.0000,
                                      3293.8000, 3294.8000, 3295.6001, 3296.2000, 3297.2000, 3298.0000, 3299.0000, 3300.0000, 3301.0000, 3302.0000, 3303.0000, 3304.0000, 3305.0000, 3306.0000, 3307.0000,
                                      3307.8000, 3308.8000, 3309.8000, 3310.8000, 3311.8000, 3312.8000, 3313.6001, 3314.3999, 3315.2000, 3316.0000, 3317.0000, 3317.8000, 3318.8000, 3319.8000, 3320.6001,
                                      3321.2000, 3322.0000, 3323.0000, 3324.0000, 3324.8000, 3325.8000, 3326.8000, 3327.3999, 3328.2000, 3329.0000, 3329.8000, 3330.8000, 3331.3999, 3332.0000, 3333.0000,
                                      3333.8000, 3334.6001, 3335.2000, 3336.0000, 3336.8000, 3337.8000, 3338.6001, 3339.0000, 3340.0000, 3340.8000, 3341.8000, 3342.3999, 3343.0000, 3344.0000, 3345.0000,
                                      3346.0000, 3347.0000, 3348.0000, 3349.0000, 3350.0000, 3351.0000, 3352.2000, 3353.2000, 3354.3999, 3355.3999, 3356.6001, 3357.8000, 3358.8000, 3359.8000, 3360.8000,
                                      3361.3999, 3362.2000, 3363.0000, 3364.0000, 3364.8000, 3365.8000, 3366.3999, 3367.2000, 3368.0000, 3369.0000, 3369.8000, 3370.8000, 3371.3999, 3372.0000, 3373.0000,
                                      3374.0000, 3374.8000, 3375.8000, 3376.3999, 3377.3999, 3378.2000, 3379.2000, 3380.0000, 3381.0000, 3382.0000, 3383.0000, 3384.0000, 3385.0000, 3386.0000, 3387.0000,
                                      3387.8000, 3388.8000, 3389.8000, 3390.8000, 3391.8000, 3392.8000, 3393.3999, 3394.0000, 3395.0000, 3395.8000, 3396.8000, 3397.3999, 3398.2000, 3399.0000, 3399.8000,
                                      3400.8000, 3401.6001, 3402.2000, 3403.0000, 3404.0000, 3404.8000, 3405.8000, 3406.3999, 3407.0000, 3408.0000, 3408.8000, 3409.8000, 3410.3999, 3411.0000, 3412.0000,
                                      3412.8000, 3413.8000, 3414.3999, 3415.0000, 3416.0000, 3416.8000, 3417.8000, 3418.3999, 3419.0000, 3420.0000, 3420.8000, 3421.8000, 3422.3999, 3423.0000, 3424.0000,
                                      3424.8000, 3425.6001, 3426.0000, 3427.0000, 3427.8000, 3428.3999, 3429.0000, 3429.8000, 3430.8000, 3431.3999, 3432.0000, 3432.8000, 3433.8000, 3434.2000, 3435.0000,
                                      3435.8000, 3436.6001, 3437.0000, 3438.0000, 3438.8000, 3439.3999, 3440.0000, 3440.8000, 3441.6001, 3442.0000, 3442.8000, 3443.8000, 3444.2000, 3445.0000, 3445.8000,
                                      3446.2000, 3447.0000, 3447.8000, 3448.3999, 3449.0000, 3449.8000, 3450.3999, 3451.0000, 3451.8000, 3452.6001, 3453.0000, 3453.8000, 3454.6001, 3455.0000, 3455.8000,
                                      3456.8000, 3457.8000, 3458.3999, 3459.2000, 3460.0000, 3461.0000, 3462.0000, 3462.8000, 3463.8000, 3464.8000, 3465.6001, 3466.2000, 3467.0000, 3468.0000, 3469.0000,
                                      3469.8000, 3470.8000, 3471.8000, 3472.6001, 3473.3999, 3474.2000, 3475.0000, 3476.0000, 3477.0000, 3478.0000, 3478.8000, 3479.8000, 3480.8000, 3481.8000, 3482.6001,
                                      3483.3999, 3484.2000, 3485.2000, 3486.0000, 3487.0000, 3488.0000, 3488.8000, 3489.3999, 3490.0000, 3490.8000, 3491.2000, 3492.0000, 3492.8000, 3493.2000, 3494.0000,
                                      3494.8000, 3495.2000, 3496.0000, 3496.8000, 3497.2000, 3498.0000, 3498.8000, 3499.0000, 3499.8000, 3500.6001, 3501.0000, 3501.8000, 3502.6001, 3503.0000, 3503.8000,
                                      3504.8000, 3505.6001, 3506.3999, 3507.0000, 3508.0000, 3509.0000, 3509.8000, 3510.8000, 3511.8000, 3512.8000, 3513.3999, 3514.2000, 3515.0000, 3516.0000, 3517.0000,
                                      3517.8000, 3518.8000, 3519.8000, 3520.6001, 3521.2000, 3522.0000, 3523.0000, 3523.8000, 3524.8000, 3525.3999, 3526.0000, 3527.0000, 3527.8000, 3528.8000, 3529.6001,
                                      3530.2000, 3531.0000, 3532.0000, 3532.8000, 3533.8000, 3534.3999, 3535.0000, 3536.0000, 3536.8000, 3537.6001, 3538.2000, 3539.0000, 3539.8000, 3540.6001, 3541.2000,
                                      3542.0000, 3542.8000, 3543.6001, 3544.0000, 3545.0000, 3545.8000, 3546.6001, 3547.0000, 3548.0000, 3548.8000, 3549.6001, 3550.0000, 3551.0000, 3551.8000, 3552.3999,
                                      3553.0000, 3554.0000, 3554.8000, 3555.3999, 3556.0000, 3557.0000, 3557.8000, 3558.3999, 3559.0000, 3560.0000, 3560.8000, 3561.3999, 3562.0000, 3563.0000, 3563.8000,
                                      3564.3999, 3565.0000, 3566.0000, 3566.8000, 3567.3999, 3568.0000, 3569.8000, 3571.0000, 3572.8000, 3574.0000, 3575.8000, 3577.0000, 3578.6001, 3580.0000, 3581.6001,
                                      3583.0000, 3584.2000, 3585.0000, 3585.8000, 3586.3999, 3587.0000, 3587.8000, 3588.3999, 3589.0000, 3589.8000, 3590.6001, 3591.0000, 3591.8000, 3592.6001, 3593.0000,
                                      3594.0000, 3594.8000, 3595.2000, 3596.0000, 3596.8000, 3597.2000, 3598.0000, 3598.8000, 3599.3999, 3600.0000, 3600.8000, 3601.6001, 3602.0000, 3602.8000, 3603.8000,
                                      3604.2000, 3605.0000, 3605.8000, 3606.2000, 3607.0000, 3607.8000, 3608.3999, 3609.0000, 3609.8000, 3610.6001, 3611.0000, 3612.0000, 3612.8000, 3613.2000, 3614.0000,
                                      3614.8000, 3615.3999, 3616.0000, 3616.8000, 3617.6001, 3618.0000, 3619.0000, 3619.8000, 3620.2000, 3621.0000, 3621.8000, 3622.3999, 3623.0000, 3623.8000, 3624.6001,
                                      3625.0000, 3626.0000, 3626.8000, 3627.2000, 3628.0000, 3628.8000, 3629.3999, 3630.0000, 3630.8000, 3631.6001, 3632.0000, 3633.0000, 3634.0000, 3634.8000, 3635.8000,
                                      3636.3999, 3637.0000, 3638.0000, 3638.8000, 3639.8000, 3640.8000, 3641.3999, 3642.0000, 3643.0000, 3643.8000, 3644.8000, 3645.6001, 3646.3999, 3647.0000, 3648.0000,
                                      3648.8000, 3649.6001, 3650.0000, 3651.0000, 3651.8000, 3652.3999, 3653.0000, 3653.8000, 3654.6001, 3655.0000, 3656.0000, 3656.8000, 3657.3999, 3658.0000, 3658.8000,
                                      3659.8000, 3660.2000, 3661.0000, 3661.8000, 3662.3999, 3663.0000, 3663.8000, 3664.6001, 3665.0000, 3665.8000, 3666.2000, 3667.0000, 3667.6001, 3668.0000, 3668.8000,
                                      3669.2000, 3669.8000, 3670.6001, 3671.0000, 3671.8000, 3672.2000, 3672.8000, 3673.3999, 3674.0000, 3674.8000, 3675.0000, 3675.8000, 3676.3999, 3677.0000, 3677.8000,
                                      3678.0000, 3678.8000, 3679.3999, 3680.0000, 3680.8000, 3681.2000, 3682.0000, 3682.8000, 3683.3999, 3684.0000, 3684.8000, 3685.6001, 3686.0000, 3686.8000, 3687.8000,
                                      3688.2000, 3689.0000, 3689.8000, 3690.2000, 3691.0000, 3691.8000, 3692.3999, 3693.0000, 3693.8000, 3694.6001, 3695.0000, 3695.8000, 3696.6001, 3697.0000, 3697.8000,
                                      3698.3999, 3699.0000, 3699.8000, 3700.3999, 3701.0000, 3701.8000, 3702.2000, 3702.8000, 3703.6001, 3704.0000, 3704.8000, 3705.3999, 3706.0000, 3706.8000, 3707.2000,
                                      3708.0000, 3708.8000, 3709.0000, 3709.8000, 3710.6001, 3711.0000, 3711.8000, 3712.3999, 3713.0000, 3713.8000, 3714.8000, 3715.3999, 3716.0000, 3716.8000, 3717.8000,
                                      3718.2000, 3719.0000, 3719.8000, 3720.6001, 3721.0000, 3722.0000, 3722.8000, 3723.3999, 3724.0000, 3724.8000, 3725.8000, 3726.2000, 3727.0000, 3727.8000, 3728.6001,
                                      3729.0000, 3729.8000, 3730.0000, 3730.8000, 3731.3999, 3732.0000, 3732.6001, 3733.0000, 3733.8000, 3734.2000, 3734.8000, 3735.3999, 3736.0000, 3736.8000, 3737.0000,
                                      3737.8000, 3738.2000, 3738.8000, 3739.6001, 3740.0000, 3740.8000, 3741.0000, 3741.8000, 3742.3999, 3743.0000, 3743.6001, 3744.0000, 3744.8000, 3745.3999, 3746.0000,
                                      3746.8000, 3747.2000, 3748.0000, 3748.8000, 3749.0000, 3749.8000, 3750.6001, 3751.0000, 3751.8000, 3752.3999, 3753.0000, 3753.8000, 3754.2000, 3755.0000, 3755.8000,
                                      3756.0000, 3756.8000, 3757.6001, 3758.0000, 3758.8000, 3759.3999, 3760.0000, 3760.8000, 3761.3999, 3762.0000, 3762.8000, 3763.6001, 3764.0000, 3764.8000, 3765.8000,
                                      3766.2000, 3767.0000, 3767.8000, 3768.2000, 3769.0000, 3769.8000, 3770.3999, 3771.0000, 3771.8000, 3772.6001, 3773.0000, 3773.8000, 3774.6001, 3775.0000, 3776.0000,
                                      3776.8000, 3777.0000, 3777.8000, 3778.2000, 3778.8000, 3779.6001, 3780.0000, 3780.8000, 3781.0000, 3781.8000, 3782.3999, 3783.0000, 3783.8000, 3784.0000, 3784.8000,
                                      3785.2000, 3786.0000, 3786.6001, 3787.0000, 3787.8000, 3788.2000, 3788.8000, 3789.3999, 3790.0000, 3790.8000, 3791.0000, 3791.8000, 3792.3999, 3792.8000, 3793.3999,
                                      3794.0000, 3794.6001, 3795.0000, 3795.6001, 3796.0000, 3796.8000, 3797.0000, 3797.8000, 3798.0000, 3798.8000, 3799.0000, 3799.8000, 3800.0000, 3800.8000, 3801.2000,
                                      3801.8000, 3802.2000, 3802.8000, 3803.3999, 3803.8000, 3804.3999, 3805.0000, 3805.6001, 3806.0000, 3806.6001, 3807.0000, 3807.8000, 3808.0000, 3808.8000, 3809.3999,
                                      3810.0000, 3810.8000, 3811.3999, 3812.0000, 3812.8000, 3813.6001, 3814.0000, 3814.8000, 3815.6001, 3816.0000, 3816.8000, 3817.6001, 3818.0000, 3818.8000, 3819.8000,
                                      3820.0000, 3821.0000, 3821.8000, 3822.2000, 3823.0000, 3823.8000, 3824.2000, 3824.8000, 3825.2000, 3825.8000, 3826.3999, 3826.8000, 3827.3999, 3828.0000, 3828.3999,
                                      3829.0000, 3829.6001, 3830.0000, 3830.6001, 3831.0000, 3831.6001, 3832.0000, 3832.8000, 3833.0000, 3833.8000, 3834.0000, 3834.8000, 3835.0000, 3835.8000, 3836.0000,
                                      3836.8000, 3837.2000, 3837.8000, 3838.2000, 3838.8000, 3839.2000, 3839.8000, 3840.3999, 3841.0000, 3841.6001, 3842.0000, 3842.8000, 3843.2000, 3843.8000, 3844.3999,
                                      3845.0000, 3845.8000, 3846.0000, 3846.8000, 3847.2000, 3847.8000, 3848.3999, 3849.0000, 3849.8000, 3850.0000, 3850.8000, 3851.2000, 3851.8000, 3852.6001, 3853.0000,
                                      3853.8000, 3854.0000, 3854.8000, 3855.2000, 3856.0000, 3856.6001, 3857.0000, 3857.8000, 3858.8000, 3859.0000, 3860.0000, 3860.8000, 3861.2000, 3862.0000, 3862.8000,
                                      3863.2000, 3864.0000, 3864.8000, 3865.2000, 3866.0000, 3866.8000, 3867.2000, 3868.0000, 3868.8000, 3869.2000, 3870.0000, 3870.8000, 3871.3999, 3872.0000, 3872.8000,
                                      3873.0000, 3873.6001, 3874.0000, 3874.6001, 3875.0000, 3875.3999, 3876.0000, 3876.3999, 3876.8000, 3877.3999, 3877.8000, 3878.2000, 3878.8000, 3879.2000, 3879.8000,
                                      3880.0000, 3880.8000, 3881.0000, 3881.8000, 3882.0000, 3882.8000, 3883.0000, 3883.8000, 3884.0000, 3884.8000, 3885.0000, 3885.6001, 3886.0000, 3886.6001, 3887.0000,
                                      3887.3999, 3888.0000, 3888.6001, 3889.2000, 3890.0000, 3890.8000, 3891.6001, 3892.2000, 3893.0000, 3893.8000, 3894.6001, 3895.2000, 3896.0000, 3896.8000, 3897.8000,
                                      3898.2000, 3899.0000, 3899.8000, 3900.8000, 3901.2000, 3902.0000, 3902.8000, 3903.8000, 3904.2000, 3905.0000, 3905.6001, 3906.0000, 3906.8000, 3907.3999, 3908.0000,
                                      3908.8000, 3909.2000, 3909.8000, 3910.6001, 3911.0000, 3911.8000, 3912.2000, 3913.0000, 3913.8000, 3914.0000, 3914.8000, 3915.3999, 3916.0000, 3916.8000, 3917.2000,
                                      3918.0000, 3918.6001, 3919.0000, 3919.8000, 3920.2000, 3920.8000, 3921.3999, 3922.0000, 3922.6001, 3923.0000, 3923.6001, 3924.0000, 3924.8000, 3925.0000, 3925.8000,
                                      3926.0000, 3926.8000, 3927.2000, 3927.8000, 3928.2000, 3928.8000, 3929.3999, 3930.0000, 3930.6001, 3931.0000, 3931.6001, 3932.0000, 3932.8000, 3933.0000, 3933.8000,
                                      3934.0000, 3934.8000, 3935.0000, 3935.8000, 3936.2000, 3936.8000, 3937.6001, 3938.0000, 3938.8000, 3939.0000, 3939.8000, 3940.3999, 3941.0000, 3941.6001, 3942.0000,
                                      3942.8000, 3943.2000, 3943.8000, 3944.6001, 3945.0000, 3945.8000, 3946.0000, 3946.8000, 3947.3999, 3948.0000, 3948.6001, 3949.0000, 3949.8000, 3950.2000, 3950.8000,
                                      3951.3999, 3952.0000, 3952.8000, 3953.0000, 3953.8000, 3954.0000, 3954.8000, 3955.0000, 3955.8000, 3956.2000, 3956.8000, 3957.2000, 3957.8000, 3958.3999, 3959.0000,
                                      3959.3999, 3960.0000, 3960.6001, 3961.0000, 3961.8000, 3962.0000, 3962.8000, 3963.0000, 3963.8000, 3964.0000, 3964.8000, 3965.2000, 3965.8000, 3966.2000, 3966.8000,
                                      3967.3999, 3968.0000, 3968.3999, 3969.0000, 3969.3999, 3970.0000, 3970.6001, 3971.0000, 3971.6001, 3972.0000, 3972.6001, 3973.0000, 3973.6001, 3974.0000, 3974.6001,
                                      3975.0000, 3975.8000, 3976.0000, 3976.8000, 3977.0000, 3977.8000, 3978.0000, 3978.8000, 3979.0000, 3979.8000, 3980.0000, 3980.8000, 3981.0000, 3981.8000, 3982.0000,
                                      3982.8000, 3983.0000, 3983.8000, 3984.0000, 3984.8000, 3985.0000, 3985.8000, 3986.2000, 3986.8000, 3987.2000, 3987.8000, 3988.2000, 3988.8000, 3989.2000, 3989.8000,
                                      3990.2000, 3990.8000, 3991.2000, 3991.8000, 3992.2000, 3992.8000, 3993.2000, 3993.8000, 3994.2000, 3994.8000, 3995.2000, 3995.8000, 3996.3999, 3996.8000, 3997.3999,
                                      3997.8000, 3998.3999, 3998.8000, 3999.3999, 3999.8000, 4000.3999, 4001.0000, 4001.6001, 4002.0000, 4002.8000, 4003.0000, 4003.8000, 4004.2000, 4004.8000, 4005.3999,
                                      4006.0000, 4006.8000, 4007.0000, 4007.8000, 4008.0000, 4008.8000, 4009.3999, 4010.0000, 4010.6001, 4011.0000, 4011.8000, 4012.0000, 4012.8000, 4013.2000, 4013.8000,
                                      4014.3999, 4015.0000, 4015.6001, 4016.0000, 4016.8000, 4017.0000, 4017.8000, 4018.0000, 4018.8000, 4019.2000, 4019.8000, 4020.3999, 4021.0000, 4021.6001, 4022.0000,
                                      4022.8000, 4023.0000, 4023.8000, 4024.0000, 4024.8000, 4025.2000, 4025.8000, 4026.3999, 4027.0000, 4027.6001, 4028.0000, 4028.8000, 4029.0000, 4029.8000, 4030.0000,
                                      4030.8000, 4031.2000, 4031.8000, 4032.3999, 4033.0000, 4033.3999, 4034.0000, 4034.6001, 4035.0000, 4035.6001, 4036.0000, 4036.6001, 4037.0000, 4037.8000, 4038.0000,
                                      4038.8000, 4039.0000, 4039.8000, 4040.0000, 4040.8000, 4041.0000, 4041.8000, 4042.0000, 4042.8000, 4043.2000, 4043.8000, 4044.2000, 4044.8000, 4045.2000, 4045.8000,
                                      4046.3999, 4046.8000, 4047.3999, 4048.0000, 4048.3999, 4049.0000, 4049.6001, 4050.0000, 4050.8000, 4051.0000, 4051.8000, 4052.2000, 4052.8000, 4053.3999, 4054.0000,
                                      4054.6001, 4055.0000, 4055.8000, 4056.0000, 4056.8000, 4057.0000, 4057.8000, 4058.2000, 4058.8000, 4059.3999, 4060.0000, 4060.6001, 4061.0000, 4061.8000, 4062.0000,
                                      4062.8000, 4063.2000, 4063.8000, 4064.3999, 4065.0000, 4065.8000, 4066.0000, 4066.8000, 4067.3999, 4068.0000, 4068.8000, 4069.0000, 4069.8000, 4070.3999, 4071.0000,
                                      4071.8000, 4072.0000, 4072.8000, 4073.3999, 4074.0000, 4074.8000, 4075.0000, 4075.8000, 4076.3999, 4077.0000, 4077.8000, 4078.0000, 4078.8000, 4079.3999, 4080.00
                                    };

/*
    12 hour to 24 hour reference chart :)
  12:00 AM  00:00
  01:00 AM  01:00
  02:00 AM  02:00
  03:00 AM  03:00
  04:00 AM  04:00
  05:00 AM  05:00
  06:00 AM  06:00
  07:00 AM  07:00
  08:00 AM  08:00
  09:00 AM  09:00
  10:00 AM  10:00
  11:00 AM  11:00
  12:00 PM  12:00
  01:00 PM  13:00
  02:00 PM  14:00
  03:00 PM  15:00
  04:00 PM  16:00
  05:00 PM  17:00
  06:00 PM  18:00
  07:00 PM  19:00
  08:00 PM  20:00
  09:00 PM  21:00
  10:00 PM  22:00
  11:00 PM  23:00
*/


void Wifi_disconnected(WiFiEvent_t event, WiFiEventInfo_t info) {
  digitalWrite(red_led, HIGH);
  digitalWrite(green_led, LOW);
  WiFi.begin(WIFI_SSID, WIFI_PASS);
}

void Wifi_connected(WiFiEvent_t event, WiFiEventInfo_t info) {
  digitalWrite(red_led, LOW);
  digitalWrite(green_led, HIGH);
}



void onEventWS(AsyncWebSocket *server, AsyncWebSocketClient *client, AwsEventType type, void *arg, uint8_t *data, size_t len) {
  switch (type) {
    case WS_EVT_CONNECT:
      // Serial.printf("Websocket client #%u connected from %s\n", client->id(), client->remoteIP().toString().c_str());
      previousTimes[0] = millis();
      blinkOn = true;
      ws.textAll("TEM" + String(Thermistor(), 0));
      ws.textAll("LS" + String(lightState));
      ws.textAll(message);
      break;
    case WS_EVT_DISCONNECT:
      //Serial.printf("Websocket client #%u disconnected\n", client->id());
      break;
    case WS_EVT_DATA:
      handleWebSocketMessage(arg, data, len);
      break;
    case WS_EVT_ERROR:
      break;
  }
}

double Thermistor() {
  double Temp;
  double adc = 0;
  adc = analogRead(temperatureSensor);
  adc = ADC_LUT[(int)adc]; // This is used for the lookup table above containign alot of numbers to fix the issue with how the analog pin on the esp32 isn't quite linear
  Temp = log(((40950000 / adc) - 10000));
  Temp = 1 / (0.001129148 + (0.000234125 + (0.0000000876741 * Temp * Temp )) * Temp );
  Temp = Temp - 273.15;
  //Temp = (Temp * 9/5) + 32; //Uncomment to be in farenheit
  return Temp;
}

void initWebsocket() {
  ws.onEvent(onEventWS);
  server.addHandler(&ws);
}


void webpageHandling() {
  server.on("/", HTTP_GET, [](AsyncWebServerRequest * request) {
    //    if(!request->authenticate(HTTP_USER, HTTP_PASS)){
    //        return request->requestAuthentication();
    //
    //      }
    request->send(SPIFFS, "/index.html", String(), false);
  });
  server.on("/css.css", HTTP_GET, [](AsyncWebServerRequest * request) {
    request->send(SPIFFS, "/css.css", "text/css");
  });

  server.on("/script.js", HTTP_GET, [](AsyncWebServerRequest * request) {
    request->send(SPIFFS, "/script.js", "text/javascript");
  });

  server.begin();
}

void transmitFanCode(const char* code) {
#define FAN_HIGH "000001011111"
#define FAN_MED "000001101111"
#define FAN_LOW "000001110111"
#define FAN_OFF "000001111101"
#define CHANGE_LIGHT_COLOR "000001110110"
#define FANLIGHT_ON_OFF "000001111110"
  digitalWrite(transmitterLed, HIGH);
  mySwitch.send(code);
  digitalWrite(transmitterPin, LOW);
  digitalWrite(transmitterLed, LOW);

}


void handleWebSocketMessage(void *arg, uint8_t *data, size_t len) {
  AwsFrameInfo *info = (AwsFrameInfo*)arg;
  if (info->final && info->index == 0 && info->len == len && info -> opcode == WS_TEXT) {
    data[len] = 0;
    message = (char*)data;
    if (strcmp(message.c_str(), "FANCODE_MED") == 0) {
      transmitFanCode(FAN_MED);
      ws.textAll(message);
    }
    if (strcmp(message.c_str(), "FANCODE_LOW") == 0) {
      transmitFanCode(FAN_LOW);
      ws.textAll(message);
    }
    if (strcmp(message.c_str(), "FANCODE_OFF") == 0) {
      transmitFanCode(FAN_OFF);
      ws.textAll(message);
    }
    if (strcmp(message.c_str(), "FANCODE_HIGH") == 0) {
      transmitFanCode(FAN_HIGH);
      ws.textAll(message);
    }
    if (strcmp(message.c_str(), "FANCODE_CHANGECOLOR") == 0) {
      transmitFanCode(CHANGE_LIGHT_COLOR);
      ws.textAll(message);
    }
    if (strcmp(message.c_str(), "FANCODE_LIGHTONOFF") == 0) {
      lightState =! lightState;
      transmitFanCode(FANLIGHT_ON_OFF);
      ws.textAll(message);
      
    }
    //ProcessTimeString(message);
  }
}

bool chkTime(int thr, int tmin, int tsec) {
  time_t n;
  struct tm * timeinfo;
  time(&n);
  timeinfo = localtime(&n);
  int int_hr = timeinfo->tm_hour;
  int int_min = timeinfo->tm_min;
  int int_sec = timeinfo->tm_sec;
  if (int_hr == thr && int_min == tmin && int_sec == tsec) {
    return true;
  } else {
    return false;
  }
}

void setNTPzone() {
  configTime(0, 0, "pool.ntp.org");
  setenv("TZ", "AEST-10", 1);
  tzset();
}

void blinkWebConnectionLed() {
  if (blinkOn) {
    digitalWrite(white_led, HIGH);
    if (millis() - previousTimes[0] >= 1000) {
      digitalWrite(white_led, LOW);
      blinkOn = false;
    }
  }
}

void temperatureHandling() {
  static bool state = false;
  if(Thermistor() >= fanTOT && !state){
    state = true;
    transmitFanCode(FAN_MED);
  } else {
    transmitFanCode(FAN_OFF);
    state = true;
  }
  //(Thermistor() <= fanTOT) ? state = false : state = true;
  
}

//void configController(){ //Function to configure the fan controller if user holds button press when restarting
//  Serial.println("Going into config mode");
//  bool flag = false;
//  while(true){
//    if(!flag){
//      pinMode(red_led, OUTPUT);
//      flag = true;
//    }
//    Serial.println("went into config :)");
//    digitalWrite(red_led, millis()%5000>2500);
//  }
//}

void setup() {
  Serial.begin(115200);
  //  if(digitalRead(buttonPin)==1){
  //    configController();
  //  }
  WiFi.disconnect(true);
  WiFi.onEvent(Wifi_connected, ARDUINO_EVENT_WIFI_STA_CONNECTED);
  WiFi.onEvent(Wifi_disconnected, ARDUINO_EVENT_WIFI_STA_DISCONNECTED);
  if (!WiFi.config(local_IP, gateway, subnet, DNS)) {
    Serial.println("STA failed to configure");
  }
  WiFi.mode(WIFI_STA);
  WiFi.begin(WIFI_SSID, WIFI_PASS);
  if (!SPIFFS.begin(true)) {
    Serial.println("Error occured while trying to mount spiffs :(");
  }
  mySwitch.enableTransmit(transmitterPin);
  mySwitch.setProtocol(6);
  mySwitch.setPulseLength(328);
  pinMode(red_led, OUTPUT);
  pinMode(green_led, OUTPUT);
  pinMode(white_led, OUTPUT);
  pinMode(transmitterLed, OUTPUT);
  pinMode(temperatureSensor, INPUT);
  pinMode(transmitterPin, OUTPUT);
  setNTPzone();
  transmitFanCode(FAN_OFF); // If the fan is on turn it off for the webpage to handle the button selection better or it will be messed up
  webpageHandling();
  initWebsocket();
}

void loop() {
  blinkWebConnectionLed();
  int tempInt = Thermistor();
  static int lastTemp = 0;
  if (chkTime(fanOnTime[0], fanOnTime[1], fanOnTime[2]) && lightState) { 
    transmitFanCode(FAN_LOW);
    transmitFanCode(FANLIGHT_ON_OFF);
    lightState = false;
  }
  //temperatureHandling();

  if (chkTime(fanlightOnTime[0], fanlightOnTime[1], fanlightOnTime[2]) && !lightState) {
    transmitFanCode(FANLIGHT_ON_OFF);
    lightState = true;
  }

  if (chkTime(fanlightOffTime[0], fanlightOffTime[1], fanlightOffTime[2])) {
    transmitFanCode(FAN_OFF);
  }
  if (millis() - previousTimes[2] >= 1000) {
    previousTimes[2] = millis();
    ws.cleanupClients();
  }

  if (lastTemp != tempInt && millis() - previousTimes[4] >=1000) {
    previousTimes[4] = millis();
    lastTemp = tempInt;
    ws.textAll("TEM" + String(tempInt));
  }

  if(ktState != lightState){
    ws.textAll("LS" + String(lightState));
    ktState = lightState;
  }


}
